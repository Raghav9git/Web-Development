<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>View Incidents | SafeNet</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="icon" href="favicon.png">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif}

body{
  min-height:100vh;
  background:
    radial-gradient(circle at 20% 20%, #1b2a5a 0%, transparent 40%),
    radial-gradient(circle at 80% 10%, #3b1d6b 0%, transparent 45%),
    linear-gradient(180deg, #060814, #0b1020 60%, #05060f);
  color:#e5e7eb;
  padding-top:90px;
}

/* NAVBAR */
nav{
  position:fixed;top:0;left:0;width:100%;z-index:1000;
  display:flex;justify-content:center;flex-wrap:wrap;gap:22px;
  padding:14px 20px;
  background:rgba(8,12,30,.75);
  border-bottom:1px solid rgba(255,255,255,.08);
}
nav a{color:#dbeafe;text-decoration:none;position:relative;padding-bottom:6px}
nav a::after{content:"";position:absolute;left:0;bottom:0;width:0;height:2px;
  background:linear-gradient(90deg,#38bdf8,#a78bfa);transition:.35s}
nav a:hover::after,nav a.active::after{width:100%}

/* CONTROLS */
.controls{
  display:flex;justify-content:center;gap:28px;flex-wrap:wrap;margin:20px;
}
.control-group{
  background:rgba(2,6,23,.75);
  border:1px solid rgba(255,255,255,.08);
  border-radius:16px;padding:12px 16px;
}
.control-group h3{
  font-size:14px;margin-bottom:8px;color:#c7d2fe;text-align:center
}
.control-group button{
  margin:4px;padding:8px 14px;border-radius:12px;border:none;
  background:linear-gradient(135deg,#1e3a8a,#4c1d95);
  color:#fff;cursor:pointer;
}

/* MAP CARD */
.page{display:flex;justify-content:center;padding:20px}
.card{
  width:100%;max-width:1100px;
  background:rgba(15,23,42,.9);
  border-radius:22px;
  padding:22px;
  border:1px solid rgba(255,255,255,.08);
}
#map{height:520px;border-radius:18px;border:1px solid rgba(255,255,255,.15)}
.info{margin-top:10px;font-size:14px;color:#c7d2fe}

/* RESOURCE TRACKING */
.resources{
  margin-top:18px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:16px;
}
.resource-card{
  background:linear-gradient(135deg,#1a1f3a,#0e1327);
  border-radius:16px;
  padding:14px;
}
.resource-card h4{margin-bottom:6px}

/* INCIDENT ARCHIVE */
.archive{
  max-width:1100px;
  margin:40px auto;
  padding:0 20px;
}
.archive h2{
  text-align:center;
  margin-bottom:20px;
  background:linear-gradient(90deg,#ff5cff,#8b7cff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.filters{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:16px;margin-bottom:24px;
}
.filters select,.filters input{
  padding:10px;border-radius:12px;
  border:none;background:#141428;color:#fff;
}
.incident-list{display:none;gap:16px}
.incident-card{
  background:linear-gradient(135deg,#1a1f3a,#0e1327);
  border-radius:16px;padding:14px;
}
.tags{display:flex;gap:8px;margin-bottom:6px}
.tag{font-size:.7rem;padding:4px 10px;border-radius:999px}
.low{background:#2b6b3f}
.medium{background:#b8871a}
.extreme{background:#7a1f1f}
.type{background:#1c1c3b}

.archive-btn{
  margin:30px auto 0;
  display:none;
  padding:14px 32px;
  border:none;border-radius:999px;
  background:linear-gradient(90deg,#ff5cff,#8b7cff);
  color:#fff;cursor:pointer;
}
</style>
</head>

<body>

<nav>
  <a class="active" href="report.html">Report</a>
    <a href="home.html">Home</a>
    <a href="profile.html">Profile</a>
    <a href="settings.html">Settings</a>
    <a href="analytics.html">Analytics</a>
    <a href="your safety.html">Your Safety</a>
    <a href="want to help.html">Want To Help?</a>
    <a href="community response.html">Community Response</a>
    <a href="services.html">Services</a>
    <a href="view-incidents.html">View Incidents</a>
</nav>

<!-- MAP CONTROLS -->
<div class="controls">
  <div class="control-group">
    <h3>Weather Maps</h3>
    <button onclick="selectMap('Temperature')">Temperature</button>
    <button onclick="selectMap('Rain')">Rain / Storm</button>
  </div>
  <div class="control-group">
    <h3>Incident / Disaster Maps</h3>
    <button onclick="selectMap('VehicleAccident')">Vehicle Accidents</button>
    <button onclick="selectMap('IndustrialAccident')">Industrial Accidents</button>
  </div>
</div>

<!-- MAP -->
<div class="page">
  <div class="card">
    <div id="map"></div>
    <div class="info" id="infoText">Select a map type, then click on the map</div>

    <!-- RESOURCE TRACKING -->
    <div class="resources">
      <div class="resource-card">
        <h4>üöë Ambulance</h4>
        Status: <b>On the way</b>
      </div>
      <div class="resource-card">
        <h4>üöí Fire Brigade</h4>
        Status: <b>Reached</b>
      </div>
      <div class="resource-card">
        <h4>üè† Shelter</h4>
        Status: <b>Available</b>
      </div>
    </div>
  </div>
</div>

<!-- INCIDENT ARCHIVE -->
<div class="archive">
  <h2>Incident Archive</h2>

  <div class="filters">
    <select id="state"><option value="">State</option><option>Maharashtra</option></select>
    <select id="district"><option value="">District</option><option>Thane</option></select>
    <select id="city"><option value="">City</option><option>Thane</option></select>
    <select id="road"><option value="">Road</option><option>Eastern Express Highway</option></select>
    <input type="date" id="date">
    <select id="type"><option value="">Type</option><option>Fire</option><option>Vehicle Accident</option></select>
    <select id="severity"><option value="">Severity</option><option>Low</option><option>Medium</option><option>Extreme</option></select>
    <select id="status"><option value="">Status</option><option>Resolved</option><option>Unresolved</option></select>
  </div>

  <div class="incident-list" id="incidentList"></div>
  <button class="archive-btn" id="archiveBtn">View Entire Archive</button>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
let selectedMapType=null,map,marker=null,circle=null,baseRadius=3000;

function selectMap(type){
  selectedMapType=type;
  infoText.innerText=type+" selected. Click on map.";
}

function clearVisuals(){
  if(marker) map.removeLayer(marker);
  if(circle) map.removeLayer(circle);
}

window.onload=()=>{
  map=L.map("map").setView([19.076,72.8777],10);
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

  map.on("click",e=>{
    if(!selectedMapType){alert("Select map type first");return;}
    clearVisuals();
    marker=L.marker(e.latlng).addTo(map);

    if(selectedMapType==="VehicleAccident"){
      circle=L.circle(e.latlng,{radius:3500,color:"#ef4444",fillOpacity:.25}).addTo(map);
      marker.bindPopup("<b>Recent Vehicle Accidents</b><br>Car Collision<br>Truck Accident").openPopup();
    }
    if(selectedMapType==="IndustrialAccident"){
      circle=L.circle(e.latlng,{radius:4000,color:"#f97316",fillOpacity:.25}).addTo(map);
      marker.bindPopup("<b>Industrial Accidents</b><br>Chemical Spill<br>Machinery Accident").openPopup();
    }
    if(selectedMapType==="Temperature"){
      marker.bindPopup("<b>Temperature</b><br>28¬∞C").openPopup();
    }
    if(selectedMapType==="Rain"){
      marker.bindPopup("<b>Weather</b><br>Rainy").openPopup();
    }
  });
};

/* ARCHIVE FILTER LOGIC */
const inputs=document.querySelectorAll(".filters select,.filters input");
inputs.forEach(i=>i.onchange=renderArchive);

function renderArchive(){
  const values=[...inputs].map(i=>i.value);
  if(values.some(v=>v==="")){
    incidentList.style.display="none";
    archiveBtn.style.display="none";
    return;
  }
  incidentList.style.display="grid";
  archiveBtn.style.display="block";
  incidentList.innerHTML=`
    <div class="incident-card">
      <div class="tags">
        <span class="tag medium">Medium</span>
        <span class="tag type">Vehicle Accident</span>
      </div>
      <h4>Road Accident ‚Äì Thane</h4>
      <p>Traffic collision reported.</p>
    </div>
  `;
}
</script>

</body>
</html>
